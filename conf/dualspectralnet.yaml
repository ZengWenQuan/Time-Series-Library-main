# DualSpectralNet 配置文件 (v4, 使用分支、融合和头注册机制)

# --- 分支、融合与头模块选择 ---
continuum_branch_name: 'CNNTransformerBranch'
normalized_branch_name: 'MultiScaleCNNBranch'
fusion_name: 'CrossAttentionFusion'
head_name: 'SimpleFFN_Head'

# --- 分支参数配置 ---
continuum_branch_config:
  use_batch_norm: true
  dropout_rate: 0.1
  cnn:
    layers:
      - {out_channels: 32, kernel_size: 11, stride: 2, padding: 5}
      - {out_channels: 64, kernel_size: 7, stride: 2, padding: 3}
  transformer:
    d_model: 64
    n_heads: 4
    ffn_dim: 128
    num_layers: 2
    dropout: 0.1

normalized_branch_config:
  use_batch_norm: true
  dropout_rate: 0.1
  blocks:
    - {out_channels: 32, kernel_sizes: [3, 5, 7], use_attention: true, downsample: true, pool_size: 2}
    - {out_channels: 64, kernel_sizes: [3, 5, 7], use_attention: true, downsample: true, pool_size: 2}

# --- 融合模块参数配置 ---
fusion_config:
  # dim_cont, dim_norm 将由代码动态计算
  hidden_dim: 128
  num_heads: 4
  dropout: 0.1

# --- 头模块参数配置 ---
head_config:
  # input_dim 将由代码动态计算 (等于 fusion 模块的 output_dim)
  fc_hidden_dims: [256, 128]
  dropout: 0.2
  use_batch_norm: true

training_settings:
  loss_function: 'mse'
  loss_weights: [1.0, 1.0, 1.0, 1.0]
  lradj: 'cos'
  targets: ['Teff', 'logg', 'FeH', 'CFe']
  mixed_precision: True